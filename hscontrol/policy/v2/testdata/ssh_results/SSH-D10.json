{
  "test_id": "SSH-D10",
  "policy_file": "ssh_policies/ssh_d10.json",
  "ssh_section": [
    { "action": "accept", "src": ["user:*@passkey"], "dst": ["tag:server"], "users": ["localpart:*@passkey"] }
  ],
  "nodes": {
    "user1": {
      "rules": [
        {
          "principals": [{ "nodeIP": "100.90.199.68" }, { "nodeIP": "fd7a:115c:a1e0::2d01:c747" }],
          "sshUsers": { "root": "" },
          "action": {
            "accept": true,
            "allowAgentForwarding": true,
            "allowLocalPortForwarding": true,
            "allowRemotePortForwarding": true
          }
        },
        {
          "principals": [{ "nodeIP": "100.90.199.68" }, { "nodeIP": "fd7a:115c:a1e0::2d01:c747" }],
          "sshUsers": { "kratail2tid": "kratail2tid" },
          "action": {
            "accept": true,
            "allowAgentForwarding": true,
            "allowLocalPortForwarding": true,
            "allowRemotePortForwarding": true
          }
        }
      ]
    },
    "user-kris": { "rules": [] },
    "user-mon": {
      "rules": [
        {
          "principals": [{ "nodeIP": "100.103.90.82" }, { "nodeIP": "fd7a:115c:a1e0::9e37:5a52" }],
          "sshUsers": { "root": "" },
          "action": {
            "accept": true,
            "allowAgentForwarding": true,
            "allowLocalPortForwarding": true,
            "allowRemotePortForwarding": true
          }
        },
        {
          "principals": [{ "nodeIP": "100.103.90.82" }, { "nodeIP": "fd7a:115c:a1e0::9e37:5a52" }],
          "sshUsers": { "monitorpasskeykradalby": "monitorpasskeykradalby" },
          "action": {
            "accept": true,
            "allowAgentForwarding": true,
            "allowLocalPortForwarding": true,
            "allowRemotePortForwarding": true
          }
        }
      ]
    },
    "tagged-server": {
      "rules": [
        {
          "principals": [{ "nodeIP": "100.90.199.68" }, { "nodeIP": "fd7a:115c:a1e0::2d01:c747" }],
          "sshUsers": { "root": "" },
          "action": {
            "accept": true,
            "allowAgentForwarding": true,
            "allowLocalPortForwarding": true,
            "allowRemotePortForwarding": true
          }
        },
        {
          "principals": [{ "nodeIP": "100.90.199.68" }, { "nodeIP": "fd7a:115c:a1e0::2d01:c747" }],
          "sshUsers": { "kratail2tid": "kratail2tid" },
          "action": {
            "accept": true,
            "allowAgentForwarding": true,
            "allowLocalPortForwarding": true,
            "allowRemotePortForwarding": true
          }
        },
        {
          "principals": [{ "nodeIP": "100.103.90.82" }, { "nodeIP": "fd7a:115c:a1e0::9e37:5a52" }],
          "sshUsers": { "root": "" },
          "action": {
            "accept": true,
            "allowAgentForwarding": true,
            "allowLocalPortForwarding": true,
            "allowRemotePortForwarding": true
          }
        },
        {
          "principals": [{ "nodeIP": "100.103.90.82" }, { "nodeIP": "fd7a:115c:a1e0::9e37:5a52" }],
          "sshUsers": { "monitorpasskeykradalby": "monitorpasskeykradalby" },
          "action": {
            "accept": true,
            "allowAgentForwarding": true,
            "allowLocalPortForwarding": true,
            "allowRemotePortForwarding": true
          }
        }
      ]
    },
    "tagged-prod": { "rules": [] }
  }
}
